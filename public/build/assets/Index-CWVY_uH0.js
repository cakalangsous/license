import{u as G,r as R,c as q,a as z,w as D,o as d,b as E,d as _,e as b,f as P,h as I,g as t,i as f,j as v,n as L,t as g,F as x,k as T,l as M,m as U,p as H}from"./app-B4kXJm1R.js";import{_ as J}from"./AdminLayout-Dl7j7Lml.js";import{_ as K}from"./Card-CWZ0FrNR.js";import{_ as N}from"./Button-BorMZ65S.js";import{a as A,q as k}from"./index-CSEUMRIG.js";import"./UserGroupIcon-CyxjldZw.js";import"./ArrowLeftIcon-C4pIvMX3.js";import"./TrashIcon-CSwwSb2h.js";import"./DemoBanner-5gPpdzaD.js";import"./XMarkIcon-BknwjWvY.js";import"./TagIcon-D0dlpqbY.js";import"./keyboard-BDssWLgB.js";const u=(e,r)=>({url:u.url(e,r),method:"put"});u.definition={methods:["put"],url:"/admin/access/update/{role}"};u.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={role:e}),Array.isArray(e)&&(e={role:e[0]}),e=A(e);const h={role:e.role};return u.definition.url.replace("{role}",h.role.toString()).replace(/\/+$/,"")+k(r)};u.put=(e,r)=>({url:u.url(e,r),method:"put"});const c=e=>({url:c.url(e),method:"get"});c.definition={methods:["get","head"],url:"/admin/access"};c.url=e=>c.definition.url+k(e);c.get=e=>({url:c.url(e),method:"get"});c.head=e=>({url:c.url(e),method:"head"});const m=(e,r)=>({url:m.url(e,r),method:"post"});m.definition={methods:["post"],url:"/admin/access/role/{role}"};m.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={role:e}),Array.isArray(e)&&(e={role:e[0]}),e=A(e);const h={role:e.role};return m.definition.url.replace("{role}",h.role.toString()).replace(/\/+$/,"")+k(r)};m.post=(e,r)=>({url:m.url(e,r),method:"post"});const $={update:Object.assign(u,u),index:Object.assign(c,c),role:Object.assign(m,m)},Q={class:"row"},W={class:"col-12"},X={class:"border-b border-gray-200 dark:border-secondary-700 mb-6"},Y={class:"flex flex-wrap -mb-px text-sm font-medium text-center"},Z=["onClick"],ee={key:0,class:"mt-4"},te={class:"overflow-x-auto"},re={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},se={class:"px-6 py-4 font-medium text-gray-900 dark:text-white w-1/4 align-top"},oe={class:"flex items-center"},ae=["checked","indeterminate","onChange"],ie={class:"ml-2 font-bold capitalize"},ne={class:"px-6 py-4"},le={class:"flex flex-wrap gap-4"},ce=["value","checked","onChange"],de=["onClick"],ue={class:"mt-6 flex justify-end"},we={__name:"Index",props:{title:{type:String,default:"Access"},roles:Array,active_role:Object,permissions:Object},setup(e){const r=e,h=G();R(!1);const l=q(()=>r.active_role),i=z({perms:[]}),S=()=>{l.value&&l.value.permissions?i.perms=l.value.permissions.map(s=>s.name):i.perms=[]};D(()=>r.active_role,()=>{S()},{immediate:!0});const j=s=>{H.get($.index.url(),{role_id:s},{preserveState:!0,preserveScroll:!0,only:["active_role"]})},O=()=>{l.value&&i.put($.update.url({role:l.value.id}),{onSuccess:()=>{h.success(`Permissions for ${l.value.name} updated!`)}})},y=s=>i.perms.includes(s),C=s=>{y(s)?i.perms=i.perms.filter(n=>n!==s):i.perms.push(s)},w=s=>{const n=r.permissions[s];return n?n.every(a=>y(a.name)):!1},B=s=>{const n=r.permissions[s];if(!n)return!1;const a=n.filter(o=>y(o.name)).length;return a>0&&a<n.length},V=s=>{const n=r.permissions[s];if(w(s)){const a=n.map(o=>o.name);i.perms=i.perms.filter(o=>!a.includes(o))}else n.map(o=>o.name).forEach(o=>{i.perms.includes(o)||i.perms.push(o)})};return(s,n)=>(d(),E(J,{title:e.title},{default:_(()=>[b(P(I),{title:e.title},null,8,["title"]),t("div",Q,[t("div",W,[b(K,{title:"Roles and Access List"},{default:_(()=>[t("div",X,[t("ul",Y,[(d(!0),f(x,null,v(e.roles,a=>(d(),f("li",{key:a.id,class:"mr-2"},[t("button",{onClick:o=>j(a.id),class:L(["inline-block p-4 border-b-2 rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 transition-colors",[l.value&&l.value.id===a.id?"text-primary-600 border-primary-600 dark:text-primary-500 dark:border-primary-500":"border-transparent text-gray-500 dark:text-gray-400"]])},g(a.name),11,Z)]))),128))])]),l.value?(d(),f("div",ee,[t("form",{onSubmit:T(O,["prevent"])},[t("div",te,[t("table",re,[t("tbody",null,[(d(!0),f(x,null,v(e.permissions,(a,o)=>(d(),f("tr",{key:o,class:"border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-secondary-800"},[t("td",se,[t("div",oe,[t("input",{type:"checkbox",class:"w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",checked:w(o),indeterminate:B(o),onChange:p=>V(o)},null,40,ae),t("span",ie,g(o.replace(/_/g," ")),1)])]),t("td",ne,[t("div",le,[(d(!0),f(x,null,v(a,p=>(d(),f("div",{key:p.id,class:"flex items-center min-w-[200px]"},[t("input",{type:"checkbox",value:p.name,class:"w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",checked:y(p.name),onChange:F=>C(p.name)},null,40,ce),t("label",{class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300 cursor-pointer",onClick:F=>C(p.name)},g(p.name),9,de)]))),128))])])]))),128))])])]),t("div",ue,[b(N,{type:"submit",loading:P(i).processing},{default:_(()=>[M(" Save Changes for "+g(l.value.name),1)]),_:1},8,["loading"])])],32)])):U("",!0)]),_:1})])])]),_:1},8,["title"]))}};export{we as default};
