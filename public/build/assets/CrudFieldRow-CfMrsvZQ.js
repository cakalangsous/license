import{r as m,c as x,E as W,H as J,o as s,i as n,l as G,t as C,m as d,g as a,n as E,b as Q,y as g,I as X,J as Y,k as P,K as S,F as j,j as z,T as Z,C as ee,w as H,e as f,f as V,z as O}from"./app-CXYNX7l5.js";import"./index-BITrN0ZQ.js";import{b as te,a as le,r as re}from"./TrashIcon-DePSIVFn.js";import{r as q}from"./XMarkIcon-CPBrcqh9.js";const ae={key:0,class:"form-label"},oe={key:0,class:"text-danger"},se={class:"custom-select-container"},ne=["disabled"],ue={class:"custom-select-search-wrapper"},ie={class:"custom-select-options"},de={key:0,class:"custom-select-group-header"},pe=["onClick"],ce={key:0,class:"custom-select-check",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},fe={key:0,class:"custom-select-no-results"},ge={key:1,class:"mt-1 text-sm text-danger"},h={__name:"CustomSelect",props:{modelValue:{type:[String,Number],default:""},label:String,options:{type:Array,default:()=>[]},placeholder:{type:String,default:"Select an option..."},error:String,required:Boolean,disabled:Boolean,valueKey:{type:String,default:"value"},labelKey:{type:String,default:"label"},groupKey:{type:String,default:"group"}},emits:["update:modelValue"],setup(p,{emit:A}){const u=p,M=A,t=m(!1),c=m(""),v=m(null),U=m(null),$=m(null),L=m({}),k=o=>typeof o=="object"?o[u.valueKey]:o,_=o=>typeof o=="object"?o[u.labelKey]:o,D=o=>typeof o=="object"&&o[u.groupKey]||null,T=x(()=>{if(!u.modelValue&&u.modelValue!==0)return"";const o=u.options.find(l=>k(l)===u.modelValue);return o?_(o):u.modelValue}),y=x(()=>{const o={},l=[];u.options.forEach(r=>{const i=D(r);i?(o[i]||(o[i]=[]),o[i].push(r)):l.push(r)});const e=[];return l.length>0&&e.push({group:null,options:l}),Object.keys(o).forEach(r=>{e.push({group:r,options:o[r]})}),e}),R=x(()=>{if(!c.value)return y.value;const o=c.value.toLowerCase();return y.value.map(l=>({...l,options:l.options.filter(e=>_(e).toLowerCase().includes(o))})).filter(l=>l.options.length>0)}),K=o=>{const l=k(o);M("update:modelValue",l),t.value=!1,c.value=""},B=o=>k(o)===u.modelValue,I=()=>{if(!U.value)return;const o=U.value.getBoundingClientRect(),l=250,e=window.innerHeight-o.bottom,r=o.top,i=e<l&&r>e;L.value={position:"fixed",left:`${o.left}px`,width:`${o.width}px`,zIndex:9999,...i?{bottom:`${window.innerHeight-o.top+4}px`}:{top:`${o.bottom+4}px`}}},N=()=>{u.disabled||(t.value=!t.value,t.value&&(c.value="",ee(()=>{I()})))},F=o=>{if(v.value&&!v.value.contains(o.target)){if($.value&&$.value.contains(o.target))return;t.value=!1}},w=()=>{t.value&&I()};return W(()=>{document.addEventListener("click",F),window.addEventListener("scroll",w,!0),window.addEventListener("resize",w)}),J(()=>{document.removeEventListener("click",F),window.removeEventListener("scroll",w,!0),window.removeEventListener("resize",w)}),(o,l)=>(s(),n("div",{class:"custom-select-wrapper",ref_key:"containerRef",ref:v},[p.label?(s(),n("label",ae,[G(C(p.label)+" ",1),p.required?(s(),n("span",oe,"*")):d("",!0)])):d("",!0),a("div",se,[a("button",{ref_key:"triggerRef",ref:U,type:"button",onClick:N,class:E(["custom-select-trigger",{"custom-select-error":p.error,"custom-select-disabled":p.disabled,"custom-select-open":t.value}]),disabled:p.disabled},[a("span",{class:E(T.value?"custom-select-value":"custom-select-placeholder")},C(T.value||p.placeholder),3),(s(),n("svg",{class:E(["custom-select-arrow",{"rotate-180":t.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...l[3]||(l[3]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],10,ne),(s(),Q(Z,{to:"body"},[g(a("div",{ref_key:"dropdownRef",ref:$,class:"custom-select-dropdown",style:Y(L.value),onClick:l[2]||(l[2]=P(()=>{},["stop"]))},[a("div",ue,[g(a("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>c.value=e),type:"text",class:"custom-select-search",placeholder:"Search...",onClick:l[1]||(l[1]=P(()=>{},["stop"]))},null,512),[[S,c.value]])]),a("div",ie,[(s(!0),n(j,null,z(R.value,(e,r)=>(s(),n(j,{key:r},[e.group?(s(),n("div",de,C(e.group),1)):d("",!0),(s(!0),n(j,null,z(e.options,i=>(s(),n("div",{key:k(i),class:E(["custom-select-option",{"custom-select-option-selected":B(i)}]),onClick:b=>K(i)},[G(C(_(i))+" ",1),B(i)?(s(),n("svg",ce,[...l[4]||(l[4]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):d("",!0)],10,pe))),128))],64))),128)),R.value.length===0?(s(),n("div",fe," No options found ")):d("",!0)])],4),[[X,t.value]])]))]),p.error?(s(),n("p",ge,C(p.error),1)):d("",!0)],512))}},be={class:"border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800/50"},me={class:"px-2 py-3 align-top"},ve={class:"drag-handle cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"Drag to reorder"},ye={class:"px-3 py-3 align-top"},he={class:"px-3 py-3 align-top"},xe={class:"px-3 py-3 align-top"},ke={class:"px-3 py-3 align-top"},_e={key:0,class:"mt-2 space-y-2"},we={key:0},Ve={key:1},Oe={key:2},Ce={class:"flex items-center gap-1"},Se={class:"flex-1"},Ue={key:1,class:"mt-2 space-y-2"},$e={class:"flex-1 flex gap-1"},Te=["onUpdate:modelValue"],je=["onUpdate:modelValue"],Le=["onClick"],Re={key:1,class:"w-6"},Be={class:"px-3 py-3 align-top min-w-[180px]"},Ie={key:0,class:"mt-2 space-y-1"},Fe={class:"font-medium"},Ee=["onUpdate:modelValue","placeholder"],ze=["onClick"],Ae={class:"px-3 py-3 align-top text-center"},Me={class:"inline-flex items-center cursor-pointer"},De={class:"px-3 py-3 align-top text-center"},Ke={class:"inline-flex items-center cursor-pointer"},Ne={class:"px-3 py-3 align-top text-center"},He={class:"inline-flex items-center cursor-pointer"},qe={class:"px-3 py-3 align-top text-center"},Ge={class:"inline-flex items-center cursor-pointer"},Pe={class:"px-3 py-3 align-top text-center"},We={class:"inline-flex items-center cursor-pointer"},Je={class:"px-3 py-3 align-top text-center"},Qe={class:"inline-flex items-center cursor-pointer"},Xe={class:"px-3 py-3 align-top text-center"},Ye={__name:"CrudFieldRow",props:{index:Number,field:Object,inputTypes:Array,allValidations:Array,availableTables:{type:Array,default:()=>[]},canDelete:{type:Boolean,default:!0}},emits:["update:field","remove"],setup(p,{emit:A}){const u=p,M=A,t=m({...u.field}),c=m([]),v=m(!1),U=x(()=>{if(!t.value.input_type)return!1;const l=u.inputTypes.find(e=>e.id==t.value.input_type);return l?["select","select_multiple","checkboxes","radio"].includes(l.type):!1}),$=x(()=>{if(!t.value.input_type)return!1;const l=u.inputTypes.find(e=>e.id==t.value.input_type);return l?["custom_select","custom_select_multiple","custom_checkbox","custom_radio"].includes(l.type):!1});t.value.custom_options||(t.value.custom_options=[]),H(()=>t.value.input_type,l=>{if(!l)return;const e=u.inputTypes.find(r=>r.id==l);e&&["custom_select","custom_select_multiple","custom_checkbox","custom_radio"].includes(e.type)&&(!t.value.custom_options||t.value.custom_options.length===0)&&(t.value.custom_options=[{value:"",label:""}])});const L=()=>{t.value.custom_options.push({value:"",label:""})},k=l=>{t.value.custom_options.splice(l,1)},_=async l=>{if(!l){c.value=[];return}v.value=!0;try{const r=await(await fetch(`/admin/crud/table-columns/${l}`)).json();r.status==="success"&&(c.value=r.columns)}catch(e){console.error("Failed to fetch table columns:",e),c.value=[]}finally{v.value=!1}};H(()=>t.value.table_ref,l=>{l?_(l):(c.value=[],t.value.value_field_ref="",t.value.label_field_ref="",t.value.where_field_ref="")}),W(()=>{t.value.table_ref&&_(t.value.table_ref)});const D=()=>{t.value.where_field_ref=""};H(t,l=>{M("update:field",l)},{deep:!0});const T=x(()=>{const l=t.value.input_type;if(!l||!u.allValidations)return[];const e=u.inputTypes.find(r=>r.id==l);return e?u.allValidations.filter(r=>r.input_group?r.input_group.split(",").map(b=>b.trim()).includes(e.type):!1):[]}),y=m(""),R=()=>{if(!y.value)return;const l=y.value,e=T.value.find(r=>r.id==l);e&&(t.value.validations.some(r=>r.id==l)||(t.value.validations.push({id:l,validation:e.validation,is_input_able:e.is_input_able,placeholder:e.input_placeholder,value:""}),y.value=""))},K=l=>{t.value.validations.splice(l,1)},B=[{value:"string",label:"string",group:"Common"},{value:"text",label:"text",group:"Common"},{value:"date",label:"date",group:"Common"},{value:"boolean",label:"boolean",group:"Common"},{value:"integer",label:"integer",group:"Common"},{value:"longText",label:"longText",group:"Common"},{value:"bigIncrements",label:"bigIncrements",group:"Other"},{value:"bigInteger",label:"bigInteger",group:"Other"},{value:"binary",label:"binary",group:"Other"},{value:"char",label:"char",group:"Other"},{value:"dateTime",label:"dateTime",group:"Other"},{value:"decimal",label:"decimal",group:"Other"},{value:"double",label:"double",group:"Other"},{value:"enum",label:"enum",group:"Other"},{value:"float",label:"float",group:"Other"},{value:"foreignId",label:"foreignId",group:"Other"},{value:"json",label:"json",group:"Other"},{value:"mediumText",label:"mediumText",group:"Other"},{value:"smallInteger",label:"smallInteger",group:"Other"},{value:"time",label:"time",group:"Other"},{value:"timestamp",label:"timestamp",group:"Other"},{value:"tinyInteger",label:"tinyInteger",group:"Other"},{value:"unsignedBigInteger",label:"unsignedBigInteger",group:"Other"},{value:"unsignedInteger",label:"unsignedInteger",group:"Other"},{value:"uuid",label:"uuid",group:"Other"}],I=[{value:"none",label:"none"},{value:"null",label:"null"},{value:"as_defined",label:"as defined"}],N=l=>l.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),F=x(()=>u.inputTypes.map(l=>({value:l.id,label:N(l.type)}))),w=x(()=>T.value.map(l=>({value:l.id,label:l.validation}))),o=l=>{l&&(y.value=l,R())};return(l,e)=>(s(),n("tr",be,[a("td",me,[a("div",ve,[f(V(te),{class:"w-5 h-5 text-gray-400"})])]),a("td",ye,[g(a("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>t.value.field_name=r),type:"text",class:"w-full px-3 py-2 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-800 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",placeholder:"field_name"},null,512),[[S,t.value.field_name]])]),a("td",he,[f(h,{modelValue:t.value.field_type,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value.field_type=r),options:B,placeholder:"Select type..."},null,8,["modelValue"])]),a("td",xe,[f(h,{modelValue:t.value.default_value,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.default_value=r),options:I,placeholder:"Select default..."},null,8,["modelValue"]),t.value.default_value==="as_defined"?g((s(),n("input",{key:0,"onUpdate:modelValue":e[3]||(e[3]=r=>t.value.defined_value=r),type:"text",class:"w-full mt-2 px-3 py-2 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-800 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",placeholder:"Value"},null,512)),[[S,t.value.defined_value]]):d("",!0)]),a("td",ke,[f(h,{modelValue:t.value.input_type,"onUpdate:modelValue":e[4]||(e[4]=r=>t.value.input_type=r),options:F.value,placeholder:"Select type..."},null,8,["modelValue","options"]),U.value?(s(),n("div",_e,[a("div",null,[e[16]||(e[16]=a("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"},"Model Ref",-1)),f(h,{modelValue:t.value.table_ref,"onUpdate:modelValue":e[5]||(e[5]=r=>t.value.table_ref=r),options:p.availableTables,placeholder:"Select Table"},null,8,["modelValue","options"])]),t.value.table_ref?(s(),n("div",we,[e[17]||(e[17]=a("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"},"Value Field Ref",-1)),f(h,{modelValue:t.value.value_field_ref,"onUpdate:modelValue":e[6]||(e[6]=r=>t.value.value_field_ref=r),options:c.value,disabled:v.value,placeholder:"Select Value Field"},null,8,["modelValue","options","disabled"])])):d("",!0),t.value.table_ref?(s(),n("div",Ve,[e[18]||(e[18]=a("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"},"Label Field Ref",-1)),f(h,{modelValue:t.value.label_field_ref,"onUpdate:modelValue":e[7]||(e[7]=r=>t.value.label_field_ref=r),options:c.value,disabled:v.value,placeholder:"Select Label Field"},null,8,["modelValue","options","disabled"])])):d("",!0),t.value.table_ref?(s(),n("div",Oe,[e[19]||(e[19]=a("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"},"Where",-1)),a("div",Ce,[a("div",Se,[f(h,{modelValue:t.value.where_field_ref,"onUpdate:modelValue":e[8]||(e[8]=r=>t.value.where_field_ref=r),options:c.value,disabled:v.value,placeholder:"Select Field"},null,8,["modelValue","options","disabled"])]),t.value.where_field_ref?(s(),n("button",{key:0,type:"button",onClick:D,class:"p-1.5 text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition-colors",title:"Clear"},[f(V(q),{class:"w-4 h-4"})])):d("",!0)])])):d("",!0)])):d("",!0),$.value?(s(),n("div",Ue,[(s(!0),n(j,null,z(t.value.custom_options,(r,i)=>(s(),n("div",{key:i,class:"flex items-center gap-1"},[a("div",$e,[g(a("input",{"onUpdate:modelValue":b=>r.value=b,type:"text",class:"w-16 px-1.5 py-1 text-xs text-gray-900 border border-gray-300 rounded bg-white focus:ring-1 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white",placeholder:"Value"},null,8,Te),[[S,r.value]]),g(a("input",{"onUpdate:modelValue":b=>r.label=b,type:"text",class:"flex-1 px-1.5 py-1 text-xs text-gray-900 border border-gray-300 rounded bg-white focus:ring-1 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white",placeholder:"Label"},null,8,je),[[S,r.label]])]),i>0?(s(),n("button",{key:0,type:"button",onClick:b=>k(i),class:"p-1 text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",title:"Remove option"},[f(V(q),{class:"w-4 h-4"})],8,Le)):(s(),n("div",Re))]))),128)),a("button",{type:"button",onClick:L,class:"w-full flex items-center justify-center gap-1 px-3 py-2 text-xs font-medium text-white bg-gray-800 rounded-lg hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 transition-colors"},[f(V(le),{class:"w-4 h-4"}),e[20]||(e[20]=G(" Add New Option ",-1))])])):d("",!0)]),a("td",Be,[f(h,{"model-value":y.value,"onUpdate:modelValue":o,options:w.value,placeholder:"Add validation..."},null,8,["model-value","options"]),t.value.validations.length>0?(s(),n("div",Ie,[(s(!0),n(j,null,z(t.value.validations,(r,i)=>(s(),n("div",{key:i,class:"flex items-center gap-2 text-xs bg-primary-50 dark:bg-primary-900/30 text-primary-800 dark:text-primary-300 px-2 py-1.5 rounded-md"},[a("span",Fe,C(r.validation),1),r.is_input_able?g((s(),n("input",{key:0,"onUpdate:modelValue":b=>r.value=b,placeholder:r.placeholder||"Value",class:"w-16 px-1 py-0.5 text-xs border border-primary-300 dark:border-primary-600 rounded bg-white dark:bg-gray-800 focus:ring-1 focus:ring-primary-500"},null,8,Ee)),[[S,r.value]]):d("",!0),a("button",{type:"button",onClick:b=>K(i),class:"ml-auto text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300"},[f(V(q),{class:"w-3.5 h-3.5"})],8,ze)]))),128))])):d("",!0)]),a("td",Ae,[a("label",Me,[g(a("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=r=>t.value.row_create_page=r),class:"sr-only peer"},null,512),[[O,t.value.row_create_page]]),e[21]||(e[21]=a("div",{class:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"},null,-1))])]),a("td",De,[a("label",Ke,[g(a("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=r=>t.value.row_edit_page=r),class:"sr-only peer"},null,512),[[O,t.value.row_edit_page]]),e[22]||(e[22]=a("div",{class:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"},null,-1))])]),a("td",Ne,[a("label",He,[g(a("input",{type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=r=>t.value.row_list_page=r),class:"sr-only peer"},null,512),[[O,t.value.row_list_page]]),e[23]||(e[23]=a("div",{class:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"},null,-1))])]),a("td",qe,[a("label",Ge,[g(a("input",{type:"checkbox","onUpdate:modelValue":e[12]||(e[12]=r=>t.value.row_details_page=r),class:"sr-only peer"},null,512),[[O,t.value.row_details_page]]),e[24]||(e[24]=a("div",{class:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"},null,-1))])]),a("td",Pe,[a("label",We,[g(a("input",{type:"checkbox","onUpdate:modelValue":e[13]||(e[13]=r=>t.value.searchable=r),class:"sr-only peer"},null,512),[[O,t.value.searchable]]),e[25]||(e[25]=a("div",{class:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"},null,-1))])]),a("td",Je,[a("label",Qe,[g(a("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=r=>t.value.sortable=r),class:"sr-only peer"},null,512),[[O,t.value.sortable]]),e[26]||(e[26]=a("div",{class:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"},null,-1))])]),a("td",Xe,[p.canDelete?(s(),n("button",{key:0,type:"button",onClick:e[15]||(e[15]=r=>l.$emit("remove")),class:"p-1.5 text-red-500 hover:text-red-700 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors"},[f(V(re),{class:"w-4 h-4"})])):d("",!0)])]))}},rt=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"}));export{rt as C,h as _,Ye as a};
