import{u as E,r as k,o as r,b as l,d as c,e as d,f as o,h as N,g as e,l as b,t as i,i as x,F as j,j as A,n as O,p as h}from"./app-CXYNX7l5.js";import{c as g,g as _,h as v,i as z,_ as L}from"./AdminLayout-BzX5vIWh.js";import{_ as w}from"./Card-B-peCzvN.js";import{_ as C}from"./Button-D7awOZ5r.js";import{r as q}from"./UserGroupIcon-B_Y3lvxt.js";import{r as K}from"./TrashIcon-DePSIVFn.js";import"./ArrowLeftIcon-Bt2tPfv5.js";import"./DemoBanner-B-KdNamD.js";import"./XMarkIcon-CPBrcqh9.js";import"./TagIcon-C8r8ihxU.js";import"./index-CSEUMRIG.js";import"./keyboard-CcDRV2PE.js";const R={class:"space-y-6"},V={class:"flex flex-wrap gap-4"},X={class:"flex items-center justify-between w-full"},P={class:"text-sm text-secondary-500"},I={key:0,class:"text-center py-8 text-secondary-500"},Q={key:1,class:"overflow-x-auto"},U={class:"w-full text-sm"},G={class:"py-3 px-4 font-medium dark:text-white"},H={class:"flex items-center gap-2"},J={class:"py-3 px-4"},M={class:"py-3 px-4 text-secondary-600 dark:text-secondary-400"},W={class:"py-3 px-4 text-secondary-600 dark:text-secondary-400"},Y={class:"py-3 px-4 text-right"},Z={class:"flex justify-end gap-2"},ee=["onClick"],te=["onClick","disabled"],ye={__name:"Index",props:{title:{type:String,default:"Backup"},backups:{type:Array,default:()=>[]}},setup(u){const n=E(),p=k(!1),m=k(!1),f=k(null),B=async()=>{var s;p.value=!0;try{const t=await(await fetch("/admin/backup/database",{method:"POST",headers:{"X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}})).json();t.success?(n.success(t.message),h.reload({only:["backups"]})):n.error(t.message)}catch{n.error("Failed to create database backup")}finally{p.value=!1}},F=async()=>{var s;m.value=!0;try{const t=await(await fetch("/admin/backup/files",{method:"POST",headers:{"X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}})).json();t.success?(n.success(t.message),h.reload({only:["backups"]})):n.error(t.message)}catch{n.error("Failed to create files backup")}finally{m.value=!1}},S=s=>{window.location.href=`/admin/backup/download/${s}`},$=async s=>{var a;if(confirm("Are you sure you want to delete this backup?")){f.value=s;try{const y=await(await fetch(`/admin/backup/${s}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))||""}})).json();y.success?(n.success(y.message),h.reload({only:["backups"]})):n.error(y.message)}catch{n.error("Failed to delete backup")}finally{f.value=null}}},T=s=>s==="database"?"Database":s==="files"?"Files":"Unknown",D=s=>s==="database"?"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400";return(s,a)=>(r(),l(L,{title:u.title},{default:c(()=>[d(o(N),{title:u.title},null,8,["title"]),e("div",R,[d(w,null,{header:c(()=>[...a[0]||(a[0]=[e("span",{class:"font-semibold"},"Create Backup",-1)])]),default:c(()=>[e("div",V,[d(C,{variant:"primary",onClick:B,disabled:p.value},{default:c(()=>[p.value?(r(),l(o(g),{key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4"})):(r(),l(o(_),{key:1,class:"w-4 h-4 mr-2"})),b(" "+i(p.value?"Creating...":"Backup Database"),1)]),_:1},8,["disabled"]),d(C,{variant:"outline-primary",onClick:F,disabled:m.value},{default:c(()=>[m.value?(r(),l(o(g),{key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4"})):(r(),l(o(v),{key:1,class:"w-4 h-4 mr-2"})),b(" "+i(m.value?"Creating...":"Backup Files"),1)]),_:1},8,["disabled"])]),a[1]||(a[1]=e("p",{class:"mt-4 text-sm text-secondary-500"}," Database backup creates an SQL dump. Files backup creates a zip of storage/app/public. ",-1))]),_:1}),d(w,null,{header:c(()=>[e("div",X,[a[2]||(a[2]=e("span",{class:"font-semibold"},"Existing Backups",-1)),e("span",P,i(u.backups.length)+" backup(s)",1)])]),default:c(()=>[u.backups.length===0?(r(),x("div",I,[d(o(q),{class:"w-12 h-12 mx-auto mb-4 text-secondary-300"}),a[3]||(a[3]=e("p",null,"No backups found. Create your first backup above.",-1))])):(r(),x("div",Q,[e("table",U,[a[4]||(a[4]=e("thead",null,[e("tr",{class:"border-b dark:border-secondary-700"},[e("th",{class:"text-left py-3 px-4 font-medium text-secondary-600 dark:text-secondary-400"}," Filename "),e("th",{class:"text-left py-3 px-4 font-medium text-secondary-600 dark:text-secondary-400"}," Type "),e("th",{class:"text-left py-3 px-4 font-medium text-secondary-600 dark:text-secondary-400"}," Size "),e("th",{class:"text-left py-3 px-4 font-medium text-secondary-600 dark:text-secondary-400"}," Created "),e("th",{class:"text-right py-3 px-4 font-medium text-secondary-600 dark:text-secondary-400"}," Actions ")])],-1)),e("tbody",null,[(r(!0),x(j,null,A(u.backups,t=>(r(),x("tr",{key:t.filename,class:"border-b dark:border-secondary-700 last:border-0 hover:bg-secondary-50 dark:hover:bg-secondary-800/50"},[e("td",G,[e("div",H,[t.type==="database"?(r(),l(o(_),{key:0,class:"w-5 h-5 text-blue-500"})):(r(),l(o(v),{key:1,class:"w-5 h-5 text-purple-500"})),b(" "+i(t.filename),1)])]),e("td",J,[e("span",{class:O([D(t.type),"px-2 py-1 rounded text-xs font-medium"])},i(T(t.type)),3)]),e("td",M,i(t.size),1),e("td",W,i(t.created_at),1),e("td",Y,[e("div",Z,[e("button",{onClick:y=>S(t.filename),class:"p-2 text-secondary-600 cursor-pointer hover:text-primary dark:text-secondary-400 dark:hover:text-primary transition-colors",title:"Download"},[d(o(z),{class:"w-5 h-5"})],8,ee),e("button",{onClick:y=>$(t.filename),disabled:f.value===t.filename,class:"p-2 text-secondary-600 cursor-pointer hover:text-red-500 dark:text-secondary-400 dark:hover:text-red-400 transition-colors disabled:opacity-50",title:"Delete"},[f.value===t.filename?(r(),l(o(g),{key:0,class:"animate-spin w-5 h-5"})):(r(),l(o(K),{key:1,class:"w-5 h-5"}))],8,te)])])]))),128))])])]))]),_:1})])]),_:1},8,["title"]))}};export{ye as default};
