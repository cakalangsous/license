import{u as A,r as _,D as R,a as q,o as I,b as S,d as b,e as l,f as d,h as T,g as t,y,z as v,l as u,k as B,p as E}from"./app-CXYNX7l5.js";import{l as M,m as O,n as P,_ as G}from"./AdminLayout-BzX5vIWh.js";import{_ as j}from"./Card-B-peCzvN.js";import{_ as k}from"./Button-D7awOZ5r.js";import{_ as V}from"./FormInput-hNOoRqIu.js";import{_ as z,a as L}from"./CrudFieldRow-CfMrsvZQ.js";import{c as C}from"./index-BITrN0ZQ.js";import{d as H}from"./vuedraggable.umd-C0q7mJ5h.js";import"./UserGroupIcon-B_Y3lvxt.js";import"./ArrowLeftIcon-Bt2tPfv5.js";import"./TrashIcon-DePSIVFn.js";import"./DemoBanner-B-KdNamD.js";import"./XMarkIcon-CPBrcqh9.js";import"./TagIcon-C8r8ihxU.js";import"./index-CSEUMRIG.js";import"./keyboard-CcDRV2PE.js";const J={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},K={class:"mb-6"},Q={class:"mb-6"},W={class:"flex flex-wrap gap-6"},X={class:"inline-flex items-center cursor-pointer group"},Y={class:"inline-flex items-center cursor-pointer group"},Z={class:"inline-flex items-center cursor-pointer group"},ee={class:"inline-flex items-center cursor-pointer group"},te={class:"mb-6"},re={class:"flex items-start gap-3 p-4 mb-4 text-sm text-blue-800 rounded-lg bg-blue-50 dark:bg-blue-900/50 dark:text-blue-300",role:"alert"},ae={class:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700"},le={class:"w-full text-sm text-left"},se={class:"mt-4"},oe={class:"flex justify-end pt-4 border-t border-gray-200 dark:border-gray-700"},ke={__name:"Create",props:{title:{type:String,default:"Create CRUD"},input_types:{type:Array,default:()=>[]},all_validations:{type:Array,default:()=>[]},available_tables:{type:Array,default:()=>[]}},setup(f){const n=A(),p=_(""),c=_(""),h=_("generate_crud"),x=_(!1),o=R({create:!0,edit:!0,show:!0}),i=_([]);let U=0;const w=()=>{i.value.push({_id:++U,field_name:"",field_type:"string",default_value:"none",defined_value:"",input_type:"",table_ref:"",value_field_ref:"",label_field_ref:"",where_field_ref:"",custom_options:[],validations:[],row_create_page:!0,row_edit_page:!0,row_list_page:!0,row_details_page:!0,searchable:!0,sortable:!0})};i.value.length===0&&w();const D=()=>{p.value&&(c.value=p.value.toLowerCase().replace(/\s+/g,"_")+"s")},r=q({model_name:"",table_name:"",builder_options:"generate_crud",soft_deletes:!1,create_page:!0,edit_page:!0,show_page:!0,field_name:[],field_type:[],default_value:[],defined_value:[],input_type:[],row_create_page:[],row_edit_page:[],row_list_page:[],row_details_page:[],searchable:[],sortable:[],validations:[],table_ref:[],value_field_ref:[],label_field_ref:[],where_field_ref:[],custom_options:[]}),F=()=>{if(!p.value||!p.value.trim())return n.error("Model name is required"),!1;if(!c.value||!c.value.trim())return n.error("Table name is required"),!1;if(i.value.length===0)return n.error("At least one field is required"),!1;const m=i.value.filter(e=>e.field_name&&e.field_name.trim());if(m.length===0)return n.error("At least one field with a name is required"),!1;for(let e=0;e<m.length;e++){const a=m[e];if(!a.input_type)return n.error(`Field "${a.field_name}": Input type is required`),!1}return!0},N=()=>{if(!F())return;r.model_name=p.value,r.table_name=c.value,r.builder_options=h.value,r.soft_deletes=x.value,r.create_page=o.create,r.edit_page=o.edit,r.show_page=o.show,r.field_name=[],r.field_type=[],r.default_value=[],r.defined_value=[],r.input_type=[],r.row_create_page=[],r.row_edit_page=[],r.row_list_page=[],r.row_details_page=[],r.searchable=[],r.sortable=[],r.validations=[],r.table_ref=[],r.value_field_ref=[],r.label_field_ref=[],r.where_field_ref=[],r.custom_options=[],i.value.filter(e=>e.field_name&&e.field_name.trim()).forEach(e=>{r.field_name.push(e.field_name),r.field_type.push(e.field_type),r.default_value.push(e.default_value),r.defined_value.push(e.defined_value||""),r.input_type.push(e.input_type),r.row_create_page.push(e.row_create_page),r.row_edit_page.push(e.row_edit_page),r.row_list_page.push(e.row_list_page),r.row_details_page.push(e.row_details_page),r.searchable.push(e.searchable),r.sortable.push(e.sortable),r.table_ref.push(e.table_ref||""),r.value_field_ref.push(e.value_field_ref||""),r.label_field_ref.push(e.label_field_ref||""),r.where_field_ref.push(e.where_field_ref||""),r.custom_options.push(e.custom_options||[]);const a=[];e.validations.forEach(s=>{if(s.is_input_able&&s.value){let g={};g[s.id]=s.value,a.push(g)}else a.push(s.id)}),r.validations.push(a)}),r.post(C.store.url(),{onSuccess:()=>{n.success("CRUD generated successfully! Files created."),E.visit(C.index.url())},onError:e=>{e.message?n.error(e.message):n.error("Failed to generate CRUD. Check console for details."),console.error(e)}})},$=[{value:"generate_crud",label:"Generate CRUD"},{value:"generate_api",label:"Generate API"},{value:"generate_crud_api",label:"Generate CRUD & API"}];return(m,e)=>(I(),S(G,{title:f.title},{default:b(()=>[l(d(T),{title:f.title},null,8,["title"]),l(j,{title:f.title},{default:b(()=>[t("form",{onSubmit:B(N,["prevent"])},[t("div",J,[l(V,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=a=>p.value=a),label:"Model Name",placeholder:"e.g. Customer (singular)",required:"",onInput:D,error:d(r).errors.model_name},null,8,["modelValue","error"]),l(V,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=a=>c.value=a),label:"Table Name",placeholder:"e.g. customers",required:"",error:d(r).errors.table_name},null,8,["modelValue","error"])]),t("div",K,[l(z,{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=a=>h.value=a),label:"Builder Options",options:$,error:d(r).errors.builder_options},null,8,["modelValue","error"])]),t("div",Q,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"}," Options ",-1)),t("div",W,[t("label",X,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=a=>x.value=a),class:"sr-only peer"},null,512),[[v,x.value]]),e[8]||(e[8]=t("div",{class:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"},null,-1)),e[9]||(e[9]=t("span",{class:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300"},"Soft Deletes",-1))]),t("label",Y,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=a=>o.create=a),class:"sr-only peer"},null,512),[[v,o.create]]),e[10]||(e[10]=t("div",{class:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"},null,-1)),e[11]||(e[11]=t("span",{class:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300"},"Create Page",-1))]),t("label",Z,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=a=>o.edit=a),class:"sr-only peer"},null,512),[[v,o.edit]]),e[12]||(e[12]=t("div",{class:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"},null,-1)),e[13]||(e[13]=t("span",{class:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300"},"Edit Page",-1))]),t("label",ee,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=a=>o.show=a),class:"sr-only peer"},null,512),[[v,o.show]]),e[14]||(e[14]=t("div",{class:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"},null,-1)),e[15]||(e[15]=t("span",{class:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300"},"Show Page",-1))])])]),t("div",te,[e[20]||(e[20]=t("h4",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Fields ",-1)),t("div",re,[l(d(M),{class:"w-5 h-5 shrink-0 mt-0.5"}),e[17]||(e[17]=t("div",null,[t("span",{class:"font-medium"},"Note:"),t("ul",{class:"mt-1.5 list-disc list-inside space-y-1"},[t("li",null,[u(" Field Name should be "),t("code",{class:"px-1 py-0.5 bg-blue-100 dark:bg-blue-800 rounded"},"snake_case"),u(" (e.g. "),t("code",{class:"px-1 py-0.5 bg-blue-100 dark:bg-blue-800 rounded"},"post_title"),u(") ")]),t("li",null,[t("code",{class:"px-1 py-0.5 bg-blue-100 dark:bg-blue-800 rounded"},"id"),u(", "),t("code",{class:"px-1 py-0.5 bg-blue-100 dark:bg-blue-800 rounded"},"created_at"),u(", "),t("code",{class:"px-1 py-0.5 bg-blue-100 dark:bg-blue-800 rounded"},"updated_at"),u(" are created automatically ")])])],-1))]),t("div",ae,[t("table",le,[e[18]||(e[18]=t("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-800 dark:text-gray-400"},[t("tr",null,[t("th",{scope:"col",class:"px-2 py-3 w-10"},[t("span",{class:"sr-only"},"Drag")]),t("th",{scope:"col",class:"px-3 py-3"}," Field Name "),t("th",{scope:"col",class:"px-3 py-3"}," DB Type "),t("th",{scope:"col",class:"px-3 py-3"}," Default "),t("th",{scope:"col",class:"px-3 py-3"}," Input Type "),t("th",{scope:"col",class:"px-3 py-3"}," Validation "),t("th",{scope:"col",class:"px-3 py-3 text-center"}," Create "),t("th",{scope:"col",class:"px-3 py-3 text-center"}," Edit "),t("th",{scope:"col",class:"px-3 py-3 text-center"}," List "),t("th",{scope:"col",class:"px-3 py-3 text-center"}," Details "),t("th",{scope:"col",class:"px-3 py-3 text-center"}," Search "),t("th",{scope:"col",class:"px-3 py-3 text-center"}," Sort "),t("th",{scope:"col",class:"px-3 py-3 text-center"}," Action ")])],-1)),l(d(H),{modelValue:i.value,"onUpdate:modelValue":e[7]||(e[7]=a=>i.value=a),tag:"tbody","item-key":"_id",handle:".drag-handle",animation:200,"ghost-class":"opacity-50",class:"bg-white dark:bg-gray-900"},{item:b(({element:a,index:s})=>[l(L,{index:s,field:a,"input-types":f.input_types,"all-validations":f.all_validations,"available-tables":f.available_tables,"can-delete":s>0,"onUpdate:field":g=>Object.assign(i.value[s],g),onRemove:g=>i.value.splice(s,1)},null,8,["index","field","input-types","all-validations","available-tables","can-delete","onUpdate:field","onRemove"])]),_:1},8,["modelValue"])])]),t("div",se,[l(k,{type:"button",onClick:w,variant:"outline-primary",size:"sm"},{default:b(()=>[l(d(O),{class:"w-4 h-4 mr-1"}),e[19]||(e[19]=u(" Add Field ",-1))]),_:1})])]),t("div",oe,[l(k,{type:"submit",loading:d(r).processing,variant:"primary"},{default:b(()=>[l(d(P),{class:"w-4 h-4 mr-2"}),e[21]||(e[21]=u(" Generate CRUD ",-1))]),_:1},8,["loading"])])],32)]),_:1},8,["title"])]),_:1},8,["title"]))}};export{ke as default};
